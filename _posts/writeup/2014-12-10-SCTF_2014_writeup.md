---
layout: post
title: SCTF-2014 writeup
category: writeup
tags: ctf
keywords: 
description: 
---

## code200: 

![code200](/public/img/2014-12-10-SCTF-2014_writeup-1.jpg)

个题目看着描述很复杂，实际上把数字转成二进制，输出二进制位上是 1 的位置序号就可以了。需要注意的是奇偶位是有符号的，如果最高位序号是奇数，需要在前面补一个偶数位。
编程的任务等待以后python练习的时候补吧。

## code400:

![code400](/public/img/2014-12-10-SCTF-2014_writeup-2.jpg)

```python

import json
import hashlib
import os
import base64
from Crypto.Cipher import AES
 
fp = open("secret.json", "r")
secret = json.load(fp)
fp.close()
 
if type(secret["the answer to life the universe and everything"]) != type(u"77"):
    destroy_the_universe()
 
answer = hashlib.sha1(secret["the answer to life the universe and everything"]).hexdigest()[0:16]
key = hashlib.sha1(secret["Don't google what it is"]).digest()[0:6]
 
if ord(key[4])*(ord(key[5])-5) != 17557:
    destroy_the_universe()
 
keys = ["hey"+key[2]+"check"+key[3]+"it"+key[0]+"out", 
        "come"+key[1]+"on"+key[4]+"baby"+key[5]+"~~!"]
answer = AES.new(keys[1], AES.MODE_ECB).encrypt(AES.new(keys[0], AES.MODE_ECB).encrypt(answer))
 
if base64.b64encode(answer) == "fm2knkCBHPuhCQHYE3spag==":
    fp = open("%s.txt" % hashlib.sha256(key).hexdigest(), "w")
    fp.write(secret["The entrance to the new world"])
    fp.close()
```